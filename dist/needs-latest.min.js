/*
 * needs.js v0.0.1
 * http://minion.org
 *
 * (c) 2012, Taka Kojima (taka@gigafied.com)
 * Licensed under the MIT License
 *
 * Date: Tue Feb 21 22:54:35 2012 -0800
 */
 (function(a){function k(a){return typeof a=="string"}function l(a){return a instanceof Array}function m(a){return typeof a=="object"}function n(a){return typeof a=="function"}function o(a){return l(a)?a:[a]}function p(a){return setTimeout(a,0)}function q(a){a=a.replace(/(?:^|[^\.])(\.\/)/g,"/");var b="";while(b!==a)b=a,a=a.replace(/([\w,\-]*[\/]{1,})([\.]{2,}\/)/g,"/");return a=a.replace(/(\/{2,})/g,"/"),a}function r(a){return a.substr(a.lastIndexOf(z.separator)+1)}function s(a){return a?a.substr(0,a.lastIndexOf(z.separator)):a}function t(a,b){return b=b||z.rootPath,q([b,a].join("/"))}function u(){var b,c,d,f,g;f={};for(b=0,d=e.length;b<d;b++){g=!0,f=e[b];for(c=f.m.length-1;c>=0;c--)if(!z.get(f.m[c])){g=!1;break}g&&(e.splice(b,1),d--,f.cb&&(f.cb.apply(a,z.get(f.m)),f.cb=null))}}function v(){var a=g,b,c;for(b=0;b<a.length;b++)c=a[b],c.e+=h,c.e>=z.errorTimeout&&c.s.onerror();a.length>0&&setTimeout(v,h)}function w(a,b,c){c=c||0;var d=document,e="body",f,h;if(!d[e]||c){setTimeout(function(){w(a,b)},c);return}h=d.createElement("script"),h.async=!0,f={f:a,m:b,e:0,s:h},g.push(f),h.onreadystatechange=h.onload=function(a){function b(){i={path:f.f,id:f.m}}f.s.onload=f.s.onreadystatechange=null,f.s.onerror=null,g.splice(g.indexOf(f),1),i?b():p(b)},h.onerror=function(a){throw f.s.onload=f.s.onreadystatechange=null,f.s.onerror=null,g.splice(g.indexOf(f),1),Error(f.m+" failed to load. Attempted to load from file: "+f.f)},h.src=a,d[e].appendChild(h)}function x(a){e.push(a);for(var b=0;b<a.f.length;b+=1)d?(require(a.f[b]),i={path:a.f[b],id:a.m[b]}):f.indexOf(a.f[b])<0&&(f.push(a.f[b]),w(a.f[b],a.m[b],(b+1)*5));setTimeout(v,h)}function y(a,b,c){a=a||"",c=c||!1;var d=j,e;if(a&&!m(a)&&!n(a)){var f=a.split(z.separator);for(e=0;e<f.length;e+=1){if(!d[f[e]]){if(!b)return!1;d[f[e]]={}}d=d[f[e]]}}else{if(a==="")return!1;d=a}if(c)for(var g in c)d[g]=c[g];return d}"use strict",Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){if(!!this.length&&this instanceof Array&&arguments.length>=1){b=b||0;if(b<this.length){while(b<this.length){if(this[b]===a)return b;b++}return-1}return-1}return-1});var b,c=[],d=typeof window=="undefined",e=[],f=[],g=[],h=500,i=null,j={},z={};return z.errorTimeout=2e4,z.rootPath="",z.fileSuffix="",z.separator="/",z.configure=function(a){a=a||{},z.rootPath=a.rootPath||z.rootPath,z.rootPath=z.rootPath.lastIndexOf("/")===z.rootPath.length-1?z.rootPath:z.rootPath+"/",z.separator=a.separator||z.separator,z.fileSuffix=a.fileSuffix||z.fileSuffix;if(a.paths)for(var c=0;c<a.paths.length;c++){var d=a.paths[c];z.provides(d.file,d.modules)}b=!0},z.define=function(){function e(){if(!a&&!i){p(e);return}var f=i?i.id:null,g=i?i.path:null;i=null,b=b||[],a=a||f;if(b.length>0){z.require(b,function(){z.define(a,c,null,Array.prototype.slice.call(arguments,0))},g);return}n(c)&&(c=c.apply(c,d[3]||[]));var h={};h[r(a)]=c,y(s(a),!0,h),u()}var a,b,c,d=Array.prototype.slice.call(arguments,0);if(d.length===1)c=d[0];else if(d.length===2||d[2]===null)c=d[1],l(d[0])?b=d[0]:(a=d[0],c=d[1]);else{if(d.length!==3)throw Error("Invalid call to define(), expected 3 arguments, got "+d.length);a=d[0],b=d[1],c=d[2]}e()},z.get=function(a){if(!l(a))return y(a,!1);var b=[];for(var c=0;c<a.length;c++)b[c]=z.get(a[c]);return b},z.getURL=function(a){if(c[a])return c[a];var b=a.indexOf("*")>-1;return a=b?a.replace(".*",""):a,a+(b?"":".js")+(z.fileSuffix?"?"+z.fileSuffix:"")},z.provides=function(a,b){b=o(b);for(var d=0;d<b.length;d+=1)c[b[d]]=a},z.require=function(c,d,e){b||z.configure(),c=o(c);var f=[],g=[],h=[],i=!0;for(var j=0;j<c.length;j++){var k=t(c[j],s(e)),l=z.get(k);if(!l){i=!1;var m=z.getURL(k);g.push(k),f.push(m)}else h.push(l)}if(!i){var n={f:f,m:g,cb:d};p(function(){x(n)});return}d.apply(a,h)},d&&(module.exports=z),a.define=z.define,a.require=z.require,a.needs=z,z})(this);
